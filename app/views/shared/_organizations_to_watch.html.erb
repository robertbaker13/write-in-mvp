<% @organizations.each_with_index do |org, index| %>
  <% @org = org %>
  <% @index = index %>
  <%= render "shared/organization", object: @org, object: @index  %>

  <% end %>

<script>
  $(document).ready(function() {
    watchListener();
  });
  var watchListener = function () {
    $("input.btn-success.btn-xs.watch-button").on("click", function(e) {
      e.preventDefault();
      var url = this.parentElement.action;
      var $watchedCandidate = $(this).closest(".rcorners.bg-w.row")
      watch(url, $watchedCandidate);
    });
    var watch = function(url, $watchedCandidate){
      $.ajax({
        url: url,
        method: "post"
      }).done(function() {
        $watchedCandidate.toggle("fast");
      }).fail(function(){
        console.log("fail");
      });
    }
  }
</script>
